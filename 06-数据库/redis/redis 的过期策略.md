## Redis 过期策略

**1.定时删除**

在设置 key 的时候，为该 key 创建一个定时器，让定时器在 key 的过期时间来临时，对 key 进行删除

- 优点：保存内存被尽快释放
- 缺点：如果过期的 key 非常多，删除 key 会占用 CPU 资源



**2.惰性删除**

key 过期的时候不删除，当获取 key 的时候，判断 key 是否过期，如果过期则删除 key 返回 nil。

- 该操作只会在获取 key 的时候发生，并且在同一时间只会删除这一个 key，效率还是比较高的
- 缺点：如果 key 不再访问，那么这个 key 会一直保留在内存中，占用内存资源。





**3.定期删除**

每隔一段时间删除一批过期的 key

- 优点：
  - 限制了删除的频率和时长，减少对 CPU 时间的占用
  - 定期删除过期的 key，弥补懒汉式的缺点

- 缺点
  - 在内存友好方面，不如定时删除，但是还是会有无效的 key 占用内存
  - 在 CPU 友好方面，不如惰性删除
- 难点：
  - 执行时长不好划分
  - 每次删除需要记录索引位，让下一次删除从上一次删除完毕的地方开始



## Redis 采用的过期策略

Redis 采用的是惰性删除和定时任务删除。memcached 采用的是惰性删除。

